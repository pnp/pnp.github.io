"use strict";var __awaiter=this&&this.__awaiter||function(e,t,n,s){function o(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,i){function r(e){try{a(s.next(e))}catch(e){i(e)}}function c(e){try{a(s.throw(e))}catch(e){i(e)}}function a(e){e.done?n(e.value):o(e.value).then(r,c)}a((s=s.apply(e,t||[])).next())})};const parseRss=e=>{const t=new DOMParser,n=t.parseFromString(e,"text/xml"),s=Array.from(n.querySelectorAll("item"));return s.map(e=>{var n,o,i,a,r,c,l;const g=((i=e.querySelector("pubDate"))===null||i===void 0?void 0:i.textContent)||"",t=new Date(g),d=t.getFullYear(),u=("0"+(t.getMonth()+1)).slice(-2),h=("0"+t.getDate()).slice(-2),m=`${d}-${u}-${h}`,f=`${t.getDate()} ${t.toLocaleString("default",{month:"short"})}, ${d}`,p=t.toISOString();let s=((l=e.querySelector("category"))===null||l===void 0?void 0:l.textContent)||"";return s=s.split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),{title:((c=e.querySelector("title"))===null||c===void 0?void 0:c.textContent)||"",description:((o=e.querySelector("description"))===null||o===void 0?void 0:o.textContent)||"",link:((n=e.querySelector("link"))===null||n===void 0?void 0:n.textContent)||"",category:s,pubDate:f,shortDate:m,isoDate:p,mediaContentUrl:((a=e.querySelector("content"))===null||a===void 0?void 0:a.getAttribute("url"))||"",author:((r=e.querySelector("creator"))===null||r===void 0?void 0:r.textContent)||"PnP Community"}})},createRSSPost=(e,t)=>{const n=document.createElement("li");for(const n in e){const o=new RegExp(`{{${n}\\s*(\\|\\s*safeHTML)?}}`,"g"),s=e[n]||"",i=safeHTML(s);t=t.replace(o,(e,t)=>t?i:s)}return n.innerHTML=t,n},safeHTML=e=>encodeURIComponent(e),displayRss=()=>__awaiter(void 0,void 0,void 0,function*(){const t=window.rssFeedUrl,n=yield fetch(t),s=yield n.text(),o=parseRss(s).slice(0,4),e=document.querySelector("#rss-section"),i=yield fetch("templates/blog-item.html"),a=yield i.text();o.forEach(t=>{const n=createRSSPost(t,a);e&&e.appendChild(n)})});window.addEventListener("DOMContentLoaded",displayRss)